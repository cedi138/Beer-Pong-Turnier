<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Ranglisten</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="sidebar">
  <a href="index.html">Startseite</a>
  <a href="regeln.html">Regeln</a>
  <a href="teams.html">Teams</a>
  <a href="spielplan.html">Spielplan</a>
  <a href="tabelle.html" class="active">Tabelle</a>
</div>

<div class="content">
  <h1>Ranglisten</h1>

  <h2>Gruppe A</h2>
  <table id="gruppeA">
    <thead>
      <tr>
        <th>Platz</th>
        <th>Team</th>
        <th>Punkte</th>
        <th>Verhältnis</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h2>Gruppe B</h2>
  <table id="gruppeB">
    <thead>
      <tr>
        <th>Platz</th>
        <th>Team</th>
        <th>Punkte</th>
        <th>Verhältnis</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h2>Gruppe C</h2>
  <table id="gruppeC">
    <thead>
      <tr>
        <th>Platz</th>
        <th>Team</th>
        <th>Punkte</th>
        <th>Verhältnis</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script>
// Teams je Gruppe (alphabetisch)
const gruppen = {
  A: ["Team 1", "Team 2", "Team 3", "Team 4"].sort(),
  B: ["Team 5", "Team 6", "Team 7", "Team 8"].sort(),
  C: ["Team 9", "Team 10", "Team 11", "Team 12"].sort()
};

// Ergebnisse aus localStorage
const ergebnisse = JSON.parse(localStorage.getItem("spielErgebnisse") || "[]");

function berechneRangliste(gruppe, tbodyId) {
  const gruppeSpiele = ergebnisse.filter(s => s.gruppe === gruppe);

  // Alle Teams initialisieren
  const teams = {};
  gruppen[gruppe].forEach(t => teams[t] = {punkte:0, torverhältnis:0});

  // Ergebnisse verrechnen
  gruppeSpiele.forEach(spiel => {
    if (spiel.score1 > spiel.score2) teams[spiel.team1].punkte += 3;
    else if (spiel.score1 < spiel.score2) teams[spiel.team2].punkte += 3;
    else {
      teams[spiel.team1].punkte += 1;
      teams[spiel.team2].punkte += 1;
    }

    teams[spiel.team1].torverhältnis += (spiel.score1 - spiel.score2);
    teams[spiel.team2].torverhältnis += (spiel.score2 - spiel.score1);
  });

  // Sortieren: Punkte absteigend, dann Torverhältnis
  const rangliste = Object.entries(teams)
    .sort((a,b) => b[1].punkte - a[1].punkte || b[1].torverhältnis - a[1].torverhältnis);

  // Tabelle füllen
  const tbody = document.querySelector(`#${tbodyId} tbody`);
  tbody.innerHTML = "";
  rangliste.forEach((eintrag,index) => {
    const row = document.createElement("tr");
    row.innerHTML = `<td>${index+1}</td><td>${eintrag[0]}</td><td>${eintrag[1].punkte}</td><td>${eintrag[1].torverhältnis}</td>`;
    tbody.appendChild(row);
  });
}

// Alle Gruppen aktualisieren
berechneRangliste("A","gruppeA");
berechneRangliste("B","gruppeB");
berechneRangliste("C","gruppeC");
</script>

</body>
</html>
